---
title: "Analysis of Global Life Expectancy and Related Factors"
author: "Echo Chen, Andrew Kroening, Pooja Kabber, Dingkun Yang"
output: pdf_document
date: "November 23rd, 2022"
---
***Report: Your report will be an 8-10 page self-contained document describing your analysis. It should be written as a professional document that can be understood by someone with limited statistics background (e.g., a client). You are also required to submit an RMD file that includes your code for the EDA and analysis. The report should be organized as follows:***

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
```

```{r load_libraries, echo=FALSE, message=FALSE, warning=FALSE}
packages <- (c("table1", "ggplot2", "xtable", "pander","ggcorrplot", "tidyverse", "stargazer", "ggfortify", "caTools", "car", "corrplot", "gridExtra", "leaps", "Metrics", "reshape2", "moments", "mice", "cowplot", "caret",  "pROC", "arm"))
# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}
# Packages loading
invisible(lapply(packages, library, character.only = TRUE))
```

```{r read_data, echo=FALSE, fig.width=10,fig.height=4}
df_life_expectancy <- read.csv(file = '../Datasets/Life_Expectancy_Data.csv')
df_life_expectancy <- data.frame(df_life_expectancy)
df_life_expectancy$Status <- factor(df_life_expectancy$Status)
df_life_expectancy$Year <- as.factor(df_life_expectancy$Year)
df_life_expectancy$Country <- as.factor(df_life_expectancy$Country)

df_life_expectancy_2014 <- df_life_expectancy[df_life_expectancy$Year == 2014, ]

# Splits for Q2

# Training
df_life_expectancy_2014$Status_num <- rep(0,nrow(df_life_expectancy_2014))
df_life_expectancy_2014$Status_num[df_life_expectancy_2014$Status=="Developed"] <- 1
df_life_expectancy_2014_cleaned <- na.omit(df_life_expectancy_2014)
df_life_expectancy_2014_cleaned$Income.composition.of.resources <- df_life_expectancy_2014_cleaned$Income.composition.of.resources * 100 
# FOR BETTER INTERPERTATION (IT RANGES FROM 0 TO 1), After transformation, one unit would be 1 percent***

# Testing 
df_life_expectancy_2013 <- df_life_expectancy[df_life_expectancy$Year == 2013, ]
df_life_expectancy_2013$Status_num <- rep(0,nrow(df_life_expectancy_2013))
df_life_expectancy_2013$Status_num[df_life_expectancy_2013$Status=="Developed"] <- 1
df_life_expectancy_2013_cleaned <- na.omit(df_life_expectancy_2013)
df_life_expectancy_2013_cleaned$Income.composition.of.resources <- df_life_expectancy_2013_cleaned$Income.composition.of.resources * 100 
```


```{r clean_data, echo=FALSE, fig.width=10,fig.height=4}

# Moved to the block above, delete for final actions

# data <- subset(data, select = -c(Country, Year))

# set factor variables
# df_life_expectancy_2014$Status <- as.factor(df_life_expectancy_2014$Status)
# df_life_expectancy_2014$Year <- as.factor(df_life_expectancy_2014$Year)
# df_life_expectancy_2014$Country <- as.factor(df_life_expectancy_2014$Country)
```

# Abstract 

This analysis is conducted to understand which factors influence life expectancy and the development status of countries around the world. The dataset used for this research consists of national disease, economic, and social factors and was compiled by the World Health Organization (WHO). [Need to link to the dataset from Kaggle] To conduct the analysis, two research objectives are formulated: one prediction question and one inference question. Unique models are fit to each approach and the results are analyzed for utility. [Add a concluding punchline]

# Introduction

***Provide more background on the data and research questions. Be sure to cite the data and background information appropriately (APA style is fine)***

This analysis uses data from the WHO to better understand the drivers of life expectancy around the globe. We also attempt to find inferential value from the data for determining the developmental status of a given country. From the two research questions we aim to improve insights into factors that drive a country's developmental status, and the population health indicators that lead to improved life expectancy.

The particular dataset for this analysis contains national-level observations of variables related to life expectancy around the globe for a period spanning the early portion of the 21st century. The complete dataset includes observations beginning in the year 2000 and ending in the year 2015. As a full dataset, there are 2,938 observations for 22 variables. Practically, each country has approximately one observation each year, averaging 183 for each of the 16 years encompassed by the data. The dataset effectively contains 20 variables for each country and year combination, covering significant disease, economic, and social factors. Below are the questions we aim to answer in this analysis:

### Question #1 (Prediction)

*"How did major disease, economic, and social factors impact life expectancy around the globe in 2014?"*

### Question #2 (Inference)

*"How did disease and mortality rates, along with national economic factors, contribute to a country's development status in 2014?"*

# Methods

***Describe the process you used to conduct analysis. This includes EDA and any relevant data cleaning information (e.g., did you exclude missing values? If so, how many? Did you collapse categories for any variables?) Then describe the models you fit, and any changes you made to improve model fit (e.g., did you exclude any influential points? Did you do have to address multicollinearity issues? Did you transform any variables?). Also describe model diagnostics. The organization of this section may depend on your particular dataset/analysis, but you may want to break it into subsections such as “Data,” “Models,” and “Model assessment.” Note that you do not present any results in this section.***


The general methodology of our analysis centered around the ability to draw insights from the dataset without significant transformations or imputations. To accomplish this objective, the team began with exploratory data analysis (EDA) to examine the distributions of key variables. From the EDA, missing data points were identified, and decisions made for courses of action to cope with those non-values. At conclusion of data preparation, we subset for the year 2014, our focal point for this analysis, and the year 2013 as a testing validation dataset used in our second research question.

We then proceed to model fitting. [High-level how we do this.] Finally, we obtain diagnostic information about the performance of our models.

### Data

[Data introduction: address missing, factors, cleanliness, subsetting, and eda]

During the course of this initial rouund of EDA, the team identified a number of missing values from the dataset. These missing values included: 41x Population, 10x Hepatitis B, and 10x Schooling observations, with the large number of missing population values the most concerning. The team considered several approaches for mitigating the problems posed by this data, as it precludes a number of potentially influential countries from being included in this analysis. We considered multiple imputation as well as scholastic imputation for ways to mitigate these issues.

An alternative approach for missing data was identified as theoretically feasible early in the analysis process. Because of the national-level of our dataset, it is possible that we could find suitable replacement values from another source with high integrity in these areas, such as the World Bank, the International Monetary Fund, or the CIA World Factbook. While those sources had existing data for some of our missing values, we opt to not use them for replacement. Most replacement candidates we found did not match the surrounding data points (i.e. GDP figures for the country/year in question were not close enough to consider a match), and thus we have low-confidence that those values would be consistent with the WHO's data collection methods.

After the initial treatments to factor variables, our dataset is reduced to complete cases only and subset for the two years of interest in our analysis. We ultimately decide to preserve the original integrity of the data and bypass any available imputation methods. While there are certainly options available, the team assesses that the potential gain from the inclusion of the additional countries does not offset the possible bias or skew introduced from imputation. At the conclusion of these steps and decisions, we subset the data to make two sub-datasets: one for the year 2014 and one for the year 2013 which we will use in our second research question. These two datasets are nearly ideintical in size, with the 2014 dataset consisting of 131 observations, and the 2013 dataset having 130.

After some simple steps to prepare the data, the team began its EDA. [EDA plots and findings - need to truncate this and decide what's actually important to what we are trying to say]

```{r handling_missing_data, echo=FALSE}
# TODO: should we remove rows with 0 in percentage expenditure? can percentage expenditure be 0?

# complete case analysis - 183 to 131 rows
df_life_expectancy_cc_2014 <- df_life_expectancy_2014[complete.cases(df_life_expectancy_2014),]
df_life_expectancy_2014 <- df_life_expectancy_cc_2014

# stochastic imputation

# multiple imputation
```

[Does Table 1 have everything we want in it???]

```{r table_one, echo=FALSE, results="asis", header=FALSE, message=FALSE, warning=FALSE, cache=FALSE}
df_life_expectancy_14_subset <- subset(df_life_expectancy_2014,select = c(Status, Population, Life.expectancy, percentage.expenditure, Measles, Polio, HIV.AIDS, GDP, Schooling, Income.composition.of.resources, BMI, Total.expenditure))# select variables
stargazer(df_life_expectancy_14_subset,type = "latex", no.space = TRUE,
          report = ('vcsp*'), single.row = TRUE, header = FALSE,
          column.sep.width = "0.2pt",
          font.size = "small",
          title="Summary of Variables")
```

[Describe Table 1 - feels like we should add more variables]



### Models

[The model used for the first research question, the prediction question, is linear regression]

[Describe how we fit the model and the process]

```{r model1, echo=FALSE}
# model with a priori variables
mlrmod <- lm(Life.expectancy ~ Status + Population + Life.expectancy + percentage.expenditure + Measles + Polio + HIV.AIDS + GDP + Schooling + Income.composition.of.resources + BMI + Total.expenditure, data = df_life_expectancy_2014)
summary(mlrmod)

lm1 <- lm(Life.expectancy ~ ., data = subset(df_life_expectancy_cc_2014, select = -c(Country, Year)))
summary(lm1)

m <- step(lm1, trace=FALSE, direction = 'backward')
summary(m)

# final model
# final_model <- lm(formula = birth_weight ~ prev_preg + mrace + mht + mprepregwt + smoke + mrace*smoke, data = df)
# options(xtable.comment = FALSE)
# xtable(summary((final_model)), header=FALSE)
# stargazer(confint(final_model, level=0.95), header=FALSE)

par(mfrow = c(2,2))
plot(mlrmod)
plot(lm1)
plot(m)
```

```{r model1_backward, echo=FALSE}
# (?)
regfit.best <- regsubsets(Life.expectancy ~ ., data = subset(df_life_expectancy_cc_2014, select = -c(Country, Year)), nvmax = 16)
reg.summary <- summary(regfit.best)
# adjusted-R^2 with its largest value
plot(reg.summary$adjr2,xlab="Number of Variables",ylab="Adjusted Rsq",type="l")
which.max(reg.summary$adjr2)
# points(15,reg.summary$adjr2[15], col="red",cex=2,pch=20)

# BIC with its smallest value
plot(reg.summary$bic,xlab="Number of Variables",ylab="BIC",type='l')
which.min(reg.summary$bic)
# points(12,reg.summary$bic[12],col="red",cex=2,pch=20)

# backward stepwise
regfit.bwd <- regsubsets(Life.expectancy~.,data=subset(df_life_expectancy_cc_2014, select = -c(Country, Year)),nvmax=16,method="backward")
bwd.summary <- summary(regfit.bwd)

# bwd.summary
plot(bwd.summary$bic,xlab="Number of Variables",ylab="BIC",type='l')
which.min(bwd.summary$bic)
# points(12,bwd.summary$bic[12],col="red",cex=2,pch=20)
```


[The second question, the inferential one, will be approached with a logistic regression model]

[Dingkun, what is all of this]

[Multicolinearity concerns]


-----
[Following are the ones updated]



TABLE NUMBER MAY CHANGE (DUE TO QUESTION 1 PART), TAKING THAT IN MIND WHEN REFERENCING 

(num): meaning each respective model, and why we did that

(1) Since the population gaps may be large, , we use log transformation on the predictor variable, *Population*.

(2) Since VIF for Model 1 shows that *Health Expenditure/GDP per capita* and *GDP per capita* are the ones have high VIF being over 10, WE DECIDE TO DELETE *Health Expenditure/GDP per capita* by taking another variable *Health Government Expenditure Percentage* into consideration, since the later carry some portion of the same information as the former one.

(3) For better interpretation we use log transformation on  *GDP per capita* (THIS IS OUR FINAL MODEL)

(4) Just out of curiosity (SURPRISE)


**FOR BETTER INTERPERTATION (IT RANGES FROM 0 TO 1), After transformation, one unit would be 1 percent**

The fitted logistic regression with *Life Expectancy*,*Health Expenditure/GDP per capita*, *BMI*, *Health Gov. Expenditure Percentage*, *HIV/AIDS Deaths/1000 live births*,*Log of GDP per capita*, *Log of Population*, *Std. Income Composition of Resources*, *Years of Schooling* as predictors for the dataset is:

$$
\begin{aligned}
\widehat{ln(\dfrac{Developed}{Developing})}=-8.88&-0.14\ Life\ Expectancy-0.03\ BMI+0.27\ Health\ Gov.\ Expenditure\ Percentage\\
&-145.58\ HIV/AIDS\ Deaths\ per\ 1000\ live\ births-0.35\ ln(GDP\ per\ capita)\\
&+0.44\ Std.\ Income\ Composition\ of\ Resources-0.21\ ln(Population)\\
&+0.20\ Years\ of\ Schooling
\end{aligned}
$$


```{r logistic, results="asis", echo=FALSE, header=FALSE, message=FALSE, warning=FALSE}
le14_fit_full <- glm(Status_num ~ Life.expectancy + percentage.expenditure + BMI + Total.expenditure + HIV.AIDS + GDP + Income.composition.of.resources + log(Population)   + Schooling , data = df_life_expectancy_2014_cleaned, family=binomial(link="logit"))

le14_fit_semi_final <- glm(Status_num ~ Life.expectancy  + BMI + Total.expenditure + HIV.AIDS + GDP + Income.composition.of.resources + log(Population)   + Schooling , data = df_life_expectancy_2014_cleaned, family=binomial(link="logit"))

le14_fit_final <- glm(Status_num ~ Life.expectancy  + BMI + Total.expenditure + HIV.AIDS + log(GDP) + Income.composition.of.resources + log(Population)   + Schooling , data = df_life_expectancy_2014_cleaned, family=binomial(link="logit"))

le14_fit_one <- glm(Status_num ~ Income.composition.of.resources , data = df_life_expectancy_2014_cleaned, family=binomial(link="logit"))

stargazer(le14_fit_full,le14_fit_semi_final, le14_fit_final, le14_fit_one,
          dep.var.labels="Development Status",
          header=FALSE,
          no.space = TRUE,
          single.row = TRUE,
          report = ('vcsp*'),
          column.sep.width = "0.2pt",
          digits = 2,
          font.size = "small",
          title='Logistic Regression Models',
          covariate.labels=c("Life Expectancy","Health Expenditure/GDP per capita", "BMI", "Health Gov. Expenditure Percentage", "HIV/AIDS Deaths/1000 live births", "GDP per capita","Log of GDP per capita", "Std. Income Composition of Resources", "Log of Population","Years of Schooling"),
          type='latex')

```

As Table XXXX: Logistic Regression Models above shown, out of 8 predictor variables, only one predictor variable has p-values less than 0.05. The interpretation of this predictor's coefficient in terms of the odds of a country being identified or labeled as developed country is that while holding all other predictor variables constant, one percent increase in *Std. Income Composition of Resources* (prepossessed by timing 100), the odds of that country being identified as developed country increases about 1.55 ($e^{0.44}$) times .


```{r multicol test, results="asis", echo=FALSE, header=FALSE, message=FALSE, warning=FALSE, cache=FALSE}
vif_table_full <- vif(le14_fit_full)
vif_table_semi_final <- vif(le14_fit_semi_final)
vif_table_final <- vif(le14_fit_final)
vif_table_summary <- dplyr::bind_rows(vif_table_full, vif_table_semi_final, vif_table_final)
colnames(vif_table_summary) <- c("Life Expectancy","Health Expenditure/GDP per capita", "BMI", "Health Gov. Expenditure Percentage", "HIV/AIDS Deaths/1000 live births", "GDP per capita","Std. Income composition of resources", "Log of Population" , "Years of Schooling", "Log of GDP per capita")
rownames(vif_table_summary) <- c("(1)", "(2)", "(3)")
stargazer(vif_table_summary,
          summary=FALSE,
          header=FALSE,
          no.space = TRUE,
          single.row = TRUE,
          column.sep.width = "0.2pt",
          digits = 2,
          font.size = "small",
          title='Variance Inflation Factors',
          flip=TRUE,
          type='latex'
          )

```

\newpage

###### Confusion Matrix for our final model

When calculate the accuracy of the model, we use confusion matrix (as Table XXXX shown below) to calculate True Positive (TP), True Negative (TN), False Negative (FN), and False Positive (FP) count by comparing predicted values and actual values. For prediction, we use the threshold of 0.5 to classify games as Win or Loss. As you can see, the accuracy of this model is 0.94.

```{r ConfMat, results="asis", echo=FALSE, header=FALSE, message=FALSE, warning=FALSE, cache=FALSE}
conf_mat <- confusionMatrix(as.factor(ifelse(fitted(le14_fit_final)>=0.5, "Developed", "Developing")), df_life_expectancy_2014_cleaned$Status, positive = "Developed" )
# conf_mat
conf_mat_t <- matrix(c(15,4,4,108), ncol=2, byrow=TRUE)
colnames(conf_mat_t) <- c("True Developed","True Developing")
rownames(conf_mat_t) <- c("Predicted Developed","Predicted Developing")
stargazer(conf_mat_t,
          summary=FALSE,
          header=FALSE,
          no.space = TRUE,
          single.row = TRUE,
          column.sep.width = "0.2pt",
          digits = 2,
          font.size = "small",
          title="Confusion Matrix for Final Model",
          type='latex')
```

$$
\begin{aligned}
Accuracy &= \dfrac{TP + TN}{TP + FN + FP + TN}\\
&= \dfrac{15+108}{15+4+4+108}\\
&= 0.94
\end{aligned}
$$
$$
95\%\ Confidence\ Interval\ of\ Accuracy: (0.88, 0.97)
$$

### ROC Curvey for our final model


Receiver Operator Characteristic (ROC) curve (Sensitivity vs 1 - Specificity) is shown below, and the Area Under the Curve (AUC) is 0.975, when we set the threshold at 0.5.


```{r ROCFinal, results="asis", fig.width=5, fig.height=3, fig.show='hold', out.width="75%", fig.align='center', echo=FALSE, header=FALSE, message=FALSE, warning=FALSE,cache=FALSE}
invisible(roc(df_life_expectancy_2014_cleaned$Status_num,fitted(le14_fit_final),plot=T,print.thres=0.5,legacy.axes=T,
              print.auc =T,col="red3"))
```



### Using Model to predict out-of-sample probabilities

The confusion matrix of using Final Model to predict out-of-sample probabilities for Year 2013 dataset using 0.5 as the cutoff for inferring developed or developing countries is shown below as Table XXXX. The accuracy is 0.92, which shall be considered as a decent model.


```{r ConfMat_infer, results="asis", echo=FALSE, header=FALSE, message=FALSE, warning=FALSE, cache=FALSE}
df_life_expectancy_2013_cleaned$pred<- predict(le14_fit_final, df_life_expectancy_2013_cleaned, type="response")
conf_mat_pred <- confusionMatrix(as.factor(ifelse(df_life_expectancy_2013_cleaned$pred>=0.5, "Developed", "Developing")), df_life_expectancy_2013_cleaned$Status, positive = "Developed" )
# conf_mat_pred
conf_mat_pred_t <- matrix(c(13,4,6,107),ncol=2, byrow=TRUE)
colnames(conf_mat_pred_t) <- c("True Developed","True Developing")
rownames(conf_mat_pred_t) <- c("Predicted Developed","Predicted Developing")
stargazer(conf_mat_pred_t,
          summary=FALSE,
          header=FALSE,
          no.space = TRUE,
          single.row = TRUE,
          column.sep.width = "0.2pt",
          digits = 2,
          font.size = "small",
          title="Confusion Matrix for Infering Year 2013 Data",
          type='latex')
```

$$
\begin{aligned}
Accuracy &= \dfrac{TP + TN}{TP + FN + FP + TN}\\
&= \dfrac{13+107}{13+4+6+107}\\
&= 0.92
\end{aligned}
$$
$$
95\%\ Confidence\ Interval\ of\ Accuracy: (0.8631, 0.9625)
$$


Receiver Operator Characteristic (ROC) curve (Sensitivity vs 1 - Specificity) is shown below, and the Area Under the Curve (AUC) is 0.966. The fact that AUC is so close to 1 confirms that this model does a good job identifying country development status for another year, 2013.



```{r ROCPred, results="asis", fig.width=5, fig.height=3, fig.show='hold', out.width="75%", fig.align='center', echo=FALSE, header=FALSE, message=FALSE, warning=FALSE,cache=FALSE}

invisible(roc(df_life_expectancy_2013_cleaned$Status_num,df_life_expectancy_2013_cleaned$pred,plot=T,print.thres=0.5,legacy.axes=T,
              print.auc =T,col="red3"))


```

### SURPRISE MOLDE

Out of curiosity, we compare the final model with the model with only one predictor variable, *Std. Income Composition of Resources*, the ANOVA result surprisingly shows that two models are not statistically different in terms of "inference" accuracy.

As we can see on Table XXXX: Analysis of Deviance: Final Model vs Model w/ One Predictor Variable, the p-value being 0.41 is greater than 0.05, meaning *Std. Income Composition of Resources* variable by its own is a great indicator of whether the country should be considered as developed or developing country.

```{r ANOVA, results="asis", echo=FALSE, header=FALSE, message=FALSE, warning=FALSE,cache=FALSE}
anova_t <- anova(le14_fit_final, le14_fit_one, test="Chisq")
stargazer(anova_t,
          summary=FALSE,
          header=FALSE,
          no.space = TRUE,
          single.row = TRUE,
          column.sep.width = "0.2pt",
          digits = 2,
          font.size = "small",
          title='Analysis of Deviance: Final Model vs Model w/ One Predictor Variable',
          type='latex')
```








### Model Assessment

[How did we assess the linear model and its assumptions? Plots, four key assumptions, etc.]

[How did we assess the validity of the logistic model?]

# Results: 

***Here you should present results for all aspects of the analysis. The structure of this section should mirror the structure of the methods section. For example, you can start with a few key EDA results (e.g., a table of descriptive statistics), then present model results, then address assessment. This is the section where you will primarily refer to tables and figures. You should have at least 1 figure for each research question that illustrates a key result of the analysis.***

[General insights. Were the models effective, set the stage for the discussion below]

### Question 1: *"How did major disease, economic, and social factors impact life expectancy around the globe in 2014?"*

#### Model Results

[What does the model output tell us]

#### Assessment

[Assess the validity of the outputs]

### Questions 2: *"How did disease and mortality rates, along with national economic factors, contribute to a country's development status in 2014?"*

#### Model Results

[What does the model output tell us]

#### Assessment

[What kid of accuracy did we find from the model]

# Conclusion

***Describe the key takeaways from your analysis, limitations, and future work that can be done to advance knowledge in this area.***

[What is the impact of this analysis, do we think it is insightful or not?]

\newpage
# Appendix

[Presently, a dumping ground for all our images and lots until we know what we want to keep]

```{r eda, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.height=10}
# library(GGally)

# scatterplot matrix
# ggpairs(subset(df_life_expectancy_cc_2014, select = c(Life.expectancy, GDP, Population, percentage.expenditure, Hepatitis.B, Measles, Polio, HIV.AIDS, Diphtheria, Schooling, Income.composition.of.resources)))
```

```{r eda_boxplots, echo=FALSE, message=FALSE, warning=FALSE}
# boxplot matrix
life_expectancy_plot <- ggplot(df_life_expectancy_cc_2014, aes(y=Life.expectancy, x=Status, fill=Status)) + 
    geom_boxplot() + theme(axis.text=element_text(size=8),
    axis.title=element_text(size=8,face="bold"), legend.position = "none")
gdp_plot <- ggplot(df_life_expectancy_cc_2014, aes(y=GDP, x=Status, fill=Status)) + 
    geom_boxplot() + theme(axis.text=element_text(size=8),
    axis.title=element_text(size=8,face="bold"), legend.position = "none")

population_plot <- ggplot(df_life_expectancy_cc_2014, aes(y=Population, x=Status, fill=Status)) + 
    geom_boxplot() + theme(axis.text=element_text(size=8),
    axis.title=element_text(size=8,face="bold"), legend.position = "none")
percentage_expenditure_plot <- ggplot(df_life_expectancy_cc_2014, aes(y=percentage.expenditure, x=Status, fill=Status)) + 
    geom_boxplot() + theme(axis.text=element_text(size=8),
    axis.title=element_text(size=8,face="bold"), legend.position = "none")
hepatitis_plot <- ggplot(df_life_expectancy_cc_2014, aes(y=Hepatitis.B, x=Status, fill=Status)) + 
    geom_boxplot() + theme(axis.text=element_text(size=8),
    axis.title=element_text(size=8,face="bold"), legend.position = "none")
measles_plot <- ggplot(df_life_expectancy_cc_2014, aes(y=Measles, x=Status, fill=Status)) + 
    geom_boxplot() + theme(axis.text=element_text(size=8),
    axis.title=element_text(size=8,face="bold"), legend.position = "none")
polio_plot <- ggplot(df_life_expectancy_cc_2014, aes(y=Polio, x=Status, fill=Status)) + 
    geom_boxplot() + theme(axis.text=element_text(size=8),
    axis.title=element_text(size=8,face="bold"), legend.position = "none")
hiv_plot <- ggplot(df_life_expectancy_cc_2014, aes(y=HIV.AIDS, x=Status, fill=Status)) + 
    geom_boxplot() + theme(axis.text=element_text(size=8),
    axis.title=element_text(size=8,face="bold"), legend.position = "none")
diphtheria_plot <- ggplot(df_life_expectancy_cc_2014, aes(y=Diphtheria, x=Status, fill=Status)) + 
    geom_boxplot() + theme(axis.text=element_text(size=8),
    axis.title=element_text(size=8,face="bold"), legend.position = "none")
schooling_plot <- ggplot(df_life_expectancy_cc_2014, aes(y=Schooling, x=Status, fill=Status)) + 
    geom_boxplot() + theme(axis.text=element_text(size=8),
    axis.title=element_text(size=8,face="bold"), legend.position = "none")
income_plot <- ggplot(df_life_expectancy_cc_2014, aes(y=Income.composition.of.resources, x=Status, fill=Status)) + 
    geom_boxplot() + theme(axis.text=element_text(size=8),
    axis.title=element_text(size=8,face="bold"), legend.position = "none")


#gender_plot <- ggplot(airline,aes(Gender, Age))+geom_boxplot(aes(fill=Satisfaction))
plot_grid(life_expectancy_plot, gdp_plot, population_plot, percentage_expenditure_plot, hepatitis_plot, measles_plot, polio_plot, hiv_plot, diphtheria_plot, schooling_plot, income_plot, ncol=3)
```

\newpage
A few things to keep in mind:
• You should never refer to actual variable names in the text, tables, or figures. For example, if a variable for height is called “ht__cm,” you should always say “height,” and the first time you mention it you should state that it is measured in cm. In plots and tables, it should say “height (cm)”
• The report should be produced in R Markdown and knit to PDF. This may mean you need to create tables “manually” with knitr. I recommend this anyway because you can customize the labels and formatting.
• Someone should be able to read the abstract and look at the tables and figures and have a pretty good idea of 1) the goals of your analysis, and 2) the key results.
• I recommend using colorblind-friendly color palettes in your figures. It can be even better to differentiate with line types or symbols instead of relying on color.

Keep you audience in mind! A non-statistician should be able to read your report and have a good idea of what you did.
• You can have an appendix if tables or figures are too large to fit into the main text. For example, if you have several predictors, you may want to put a table of model results in the appendix.
